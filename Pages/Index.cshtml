@page
@model DisasterAlleviation.Pages.IndexModel
@{
    ViewData["Title"] = "Home";
}
@* Only set ONE notification type at a time *@
@if (TempData["GoodsDonationSuccess"] != null)
{
    <meta name="notification-type" content="goods-donation" />
    <meta name="notification-message" content="goods" />
    <meta name="notification-reference" content="@TempData["ReferenceNumber"]" />
    <meta name="notification-method" content="@TempData["DropoffMethod"]" />
    <meta name="notification-datetime" content="@TempData["DropoffDateTime"]" />
    <meta name="notification-anonymous" content="@TempData["IsAnonymous"]" />
    <meta name="notification-anonid" content="@TempData["AnonId"]" />
    <meta name="notification-donorname" content="@TempData["DonorName"]" />
}
else if (TempData["VolunteerSuccess"] != null)
{
    <meta name="notification-type" content="volunteer" />
    <meta name="notification-message" content="@TempData["VolunteerSuccess"]" />
}
else if (TempData["MonetaryDonationSuccess"] != null)
{
    @if (TempData["MonetaryDonationSuccess"].ToString() == "anonymous")
    {
        <meta name="notification-type" content="donate-anonymous" />
        <meta name="notification-message" content="@TempData["AnonId"]" />
    }
    else
    {
        <meta name="notification-type" content="donate-named" />
        <meta name="notification-message" content="@TempData["DonorName"]" />
    }
}
<!-- Hero Section -->
<section class="hero">
    <div class="hero-overlay">
        <div class="container-xl text-center">
            <h1 class="hero-title">
                Bringing Hope in <span class="highlight">Times of Crisis</span>
            </h1>
            <p class="hero-sub">
                The Disaster Alleviation Foundation provides practical aid during disasters, ensuring
                transparency and swift action when communities need it most.
            </p>
            <a href="/Donate" class="btn btn-primary btn-lg">
                <i class="bi bi-heart"></i> Donate Now
            </a>
        </div>
    </div>
</section>

<!-- Impact Section -->
<section class="impact-section">
    <div class="container-xl text-center">
        <h2 class="section-title">Our Impact by the Numbers</h2>
        <p class="section-sub">
            Transparency is at the core of our mission. Here's how your donations are making a real difference.
        </p>

        <div class="impact-grid">
            <div class="impact-card">
                <h3 class="impact-title">Total Money Donations</h3>
                <p class="impact-value">R @Model.TotalMoneyDonations</p>
                <p class="impact-foot">Received from generous donors</p>
            </div>

            <div class="impact-card">
                <h3 class="impact-title">Goods Received</h3>
                <p class="impact-value">@Model.TotalGoodsReceived</p>
                <p class="impact-foot">Items donated for distribution</p>
            </div>

            <div class="impact-card">
                <h3 class="impact-title">Total Donors</h3>
                <p class="impact-value">@Model.TotalDonors</p>
                <p class="impact-foot">Supporting our mission</p>
            </div>
        </div>
    </div>
</section>

<!-- Current Disasters -->
<section class="current-disasters">
    <div class="container-xl text-center">
        <h2 class="section-title">Current Disaster Response</h2>
        <p class="section-sub">
            See how resources are being allocated to help communities in crisis right now.
        </p>

        @if (Model.ActiveDisasters.Any())
        {
            <div id="disasterGrid" class="disaster-grid">
                @foreach (var disaster in Model.ActiveDisasters)
                {
                    <div class="disaster-card">
                        <h3 class="disaster-title">@disaster.TypeOfDisaster</h3>

                        <div class="disaster-meta">
                            <p><i class="bi bi-geo-alt"></i> @disaster.Location</p>
                            <p><i class="bi bi-calendar-event"></i> @disaster.StartDate.ToString("yyyy-MM-dd")</p>
                        </div>

                        <p class="disaster-desc">@disaster.Description</p>

                        @if (!string.IsNullOrEmpty(disaster.RequiredAidTypes))
                        {
                            <div class="aid-tags">
                                @foreach (var aid in disaster.RequiredAidTypes.Split(','))
                                {
                                    <span class="aid-tag">@aid.Trim()</span>
                                }
                            </div>
                        }

                        <div class="allocation-summary">
                            <p><strong>Status:</strong> @disaster.Status</p>
                        </div>
                    </div>
                }
            </div>

            <button id="toggleDisastersBtn" class="btn btn-outline-primary mt-4">View All Disasters</button>
        }
        else
        {
            <div class="no-disasters">
                <div class="no-icon">⚠️</div>
                <p class="no-text">No active disasters at this time.</p>
            </div>
        }
    </div>
</section>